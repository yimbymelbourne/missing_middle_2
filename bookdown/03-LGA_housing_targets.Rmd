# LGA housing targets

## Overview

The answer to the housing supply shortage will not be found in this handful of designated activity centres and precincts. `r area_name` needs to do its bit by delivering beautiful mid-rise homes near every one of its train and tram stops. 
 
Through broad transit-oriented upzoning and development, `r area_name` can deliver housing abundance and provide more housing choices to all current and future residents across the entirety of the city. This will fulfil the original goal of Plan Melbourne creating a vast array of 20-minute neighbourhoods, rather than a small number of scattered activity centres.

```{r }


mm_number <- df_lga_useful_props %>% filter(zone_short_mm == "Missing middle") %>% nrow() %>% prettyNum(big.mark = ",")
rgz_number <- df_lga_useful_props %>% filter(zone_short_mm == "Residential growth") %>% nrow() %>% prettyNum(big.mark = ",")
grz_number <- df_lga_useful_props %>% filter(zone_short_mm == "General residential") %>% nrow() %>% prettyNum(big.mark = ",")


```

In `r area_name`, `r mm_number` lots would be upzoned to the Missing Middle Zone (MMZ), enabling six-storey medium-density near all transit. A further `r rgz_number` properties will be rezoned from General Residential Zone (GRZ) to Residential Growth (RGZ), and `r grz_number` from Neighbourhood Residential Zone (NRZ) to GRZ. 

Broad upzoning is needed across existing suburbs so that there is more land available to build homes for our children to live in. If only a few select areas are rezoned, then developers will be able to buy up that land and withhold supply. Broad upzoning of land across inner-Melbourne removes any power developers may have to speculate, and lowers housing costs for all.

## New zoning map


## Current supply blockers

```{r}

#source("R/import_lga_pop_data.R")

mel_total <- lga_pop_change_importer(area_name, type = "population")


lga_change <- mel_total %>% 
  filter(year == 2021,
         lga_name_2021 == area_name) %>%
  pull(change)

mel_change <- mel_total %>% 
  filter(year == 2021,
         lga_name_2021 == "All of Melbourne") %>%
  pull(change)


  
change_ratio <- lga_change/mel_change

## TODO - get PT stops per LGA. 

text_on_growth <- case_when(change_ratio >.9 ~ paste0(params$area, " has been building housing, but cannot rest on its laurels."),
                            change_ratio >.7 ~ paste0(params$area, " has been building some housing, but it is still barely keeping up with the average for Melbourne."),
                            T ~ paste0(params$area, " is falling well behind the average for new housing in Melbourne.")
)

```

### Restrictive zoning {.tabset}
`r text_on_growth` 

`r params$area` needs the missing middle rezoning to ensure the LGA can keep up with Melbourne's population growth. 

The area has good public transport running through it, and it needs to do more to ensure that housing is abundant around this infrastructure. 

The reason `r area_name` is not building enough housing is because there are not enough areas where housing can be built. The charts below show that the majority of land in `r area_name` is locked away, preventing "Missing Middle" density from being unlocked.

### By number of lots

```{r}

dwellings_by_type <- df_lga_useful_props %>%
  group_by(category) %>% 
  summarise(n = n(),
            lot_size = sum(lot_size),
            .groups = "drop") %>% 
  group_by(category) %>% 
  mutate(n_total = sum(n),
         lot_size_total = sum(lot_size))  %>% 
  ungroup() 

dwellings_by_type %>% 
  mutate(category = fct_reorder(category,n_total)) %>% 
  ggplot(aes(x = category, 
             y = n))+
  coord_flip()+ 
  geom_bar(stat = "identity")+
  theme_yimby_mel_caption(text_size = "small",plot_type = "bar",colour_scale = "light_dark") +
  labs(x = element_blank(),
       title = paste0("Land in ",area_name," by type"),
       y = "Number of properties",
       fill = "Heritage status")

```

### By total area

```{r by total area}
dwellings_by_type %>% 
    mutate(category = fct_reorder(category,lot_size_total)) %>%
  ggplot(aes(x = category, 
             y = lot_size_total))+
  coord_flip()+ 
  geom_bar(stat = "identity")+
  theme_yimby_mel_caption(text_size = "small",plot_type = "bar",colour_scale = "light_dark") +
  labs(x = element_blank(),
       title = paste0("Land in ",area_name," by type"),
       y = "Area (sqm)",
       fill = "Heritage status")+
  scale_y_continuous(labels = scales::number_format(big.mark = ","))

```

### Table


```{r}
library(kableExtra)
library(gt)

dwellings_by_type_w_heritage <- df_lga_useful_props %>%
  group_by(category,heritage) %>% 
  summarise(n = n(),
            lot_size = sum(lot_size),
            .groups = "drop") %>% 
  group_by(category) %>% 
  mutate(n_total = sum(n),
         lot_size_total = sum(lot_size))  %>% 
  ungroup() %>% 
  mutate(heritage = if_else(heritage,
                            "Subject to heritage controls",
                            "Free from heritage"))

types_zonning <- df_lga_useful_props %>% 
  group_by(heritage) %>% 
  summarise(n = n(),
            lot_size = sum(lot_size)) %>% 
  mutate(category = "Total")%>% 
  mutate(heritage = if_else(heritage,
                            "Subject to heritage controls",
                            "Free from heritage"))


types_total_new <- df_lga_useful_props %>%
  filter(!feature_preventing_development,
         zoning_permits_housing == "Housing permitted",
         dwellings_est < 2) %>% 
  group_by(heritage) %>% 
  summarise(n = n(),
            lot_size = sum(lot_size),
            .groups = "drop") %>% 
  mutate(heritage = if_else(heritage,
                            "Subject to heritage controls",
                            "Free from heritage"),
         category = "Total where new housing can be built") 

dwellings_by_type_w_heritage %>% 
  bind_rows(types_zonning) %>% 
  bind_rows(types_total_new) %>% 
  group_by(category) %>% 
  mutate(`Share of properties that are heritage` = paste0(round(100*n/sum(n)),"%"),
         `Share of land that is heritage` =  paste0(round(100*lot_size/sum(lot_size)),"%")
         ) %>% 
  rename(`Number of properties` = n,
         `Area (sqm)` = lot_size,
         ` ` = heritage) %>% 
  select(-n_total,-lot_size_total) %>% 
    gt()  %>% 
  fmt_number(decimals = 0)

```


### Heritage overlays

```{r}

heritage_no <- df_lga_useful_props %>% 
  filter(profitable_apartments>0) %>% 
  summarise(apartments_affected_by_heritage = paste0(round(100*weighted.mean(heritage,profitable_apartments)),"%")) %>% 
  pull(apartments_affected_by_heritage) 

```
Of the `r prettyNum(round(lga_summary$profitable_apartments,-4), big.mark = ",")` potentially profitable apartments that could be built in `r area_name`, `r heritage_no` of these potential future homes are on lots subject to heritage controls. 

If heritage protections in `r area_name` are too far-reaching, it could potentially affect `r area_name`'s ability to meet its housing targets. 

If heritage is a barrier to growth then `r area_name` has three options:
1. Adjust heritage controls to allow more density on heritage land
2. Remove controls from properties of low heritage value
3. Increase zoned density further in non-heritage areas to allow adequate housing growth while maintaining heritage areas
4. Pay the required 'Housing Remedy' upon repeated failure to build a sufficient number of homes


```{r conditional-include, echo=FALSE, results='asis'}

# Conditionally include the R Markdown file
if(area_name == "Melbourne") {
  
  original_wd <- getwd()
  res <-knitr::knit_child('rmd/mel_specific_render.Rmd', quiet = TRUE,options  = c("root.dir" = original_wd))
  cat(res)
  


}

```

```{r results='asis'}
cat('<div class="button-row">')

lga_html <- paste0("https://yimby-mel.s3.ap-southeast-2.amazonaws.com/index.html")

generateButton("Back to Missing Middle zoning for all of Melbourne",lga_html)
cat('</div>')
```

**An image here should end the article.**